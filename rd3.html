<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>3. Sampling Distributions and Hypothesis Testing</title>
    <meta charset="utf-8" />
    <meta name="date" content="2023-09-21" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: middle, center, title-slide

.title[
# 3. Sampling Distributions and Hypothesis Testing
]
.date[
### 21 September 2023
]

---






### Warm-Up 1

Many programs strive to help students prepare for college entrance exams, such as the SAT. In an effort to study the effectiveness of these preparatory programs, a researcher draws a random sample of students attending public high school in the United States, and compares the SAT scores of those who took a preparatory class to those who did not. 

**What can this comparison tell us about the causal effect of preparatory courses on SAT scores?**

**Describe the relevant potential outcomes that you would need to assess the causal effect of SAT scores.**

**How you would estimate these potential outcomes?**



---

### Warm-Up 2


Suppose researchers seek to assess the effect of receiving a free newspaper subscription on students’ interest in politics. A list of student dorm rooms is drawn up and sorted randomly into treatment and control. Treated dorms receive a newspaper at their door each morning for two months; control dorm rooms do not receive a paper.

University researchers are sometimes required to disclose to subjects that they are participating in an experiment. Suppose that prior to the experiment, researchers distributed a letter informing students in the treatment group that they would be receiving a newspaper as part of a study to see if newspapers make students more interested in politics.

**How might this disclosure violate the independence assumption?**

---

### Warm-Up 3

A researcher studying 1,000 prison inmates noticed that prisoners who spend at least three hours per day reading are less likely to have violent encounters with other prisoners. The researcher therefore recommends that all prisoners be required to spend at least three hours reading each day.

Suppose that researchers were to test this researchers hypothesis by randomly assigning 10 prisoners to a treatment group. Prisoners in this group are required to go to the prison library and read in specially designated carrels for three hours each day for one week; the other prisoners, who make up the control group, go about their usual routines.

**Can you state the non-interference assumption as it applies to this experiment?**

**Do you think this assumption is met?**

--

Now let’s modify the design a bit. Suppose that every day, researchers toss a coin. If heads, then all prisoners go about their usual routines. If tails, then all prisoners are assigned to read for 3 hours in the library. The researchers the compare the average number of violent encounters on “normal days” vs “library days”. 

**Does this solve the problem?**

---

### Introduction

Randomization produces unbiased estimates of the ATE. 

But our single experiment is only one of many possible random assignments that could have occurred.

This fact produces uncertainty surrounding our estimate of the “true” ATE. 

A different random assignment to treatment and control would most likely have produced different estimates.

These ideas provide the foundation for hypothesis testing.

---

### A Motivating Example

Student   |   SAT if Test Prep    |   SAT if No Test Prep   |   Difference
-         | -                     |   -                     |   -
Alex      | 300                   |   450                   |   150
Bonnie    | 350                   |   450                   |   100
Colin     | 500                   |   600                   |   100
Danielle  | 550                   |   600                   |   50
Earl      | 700                   |   750                   |   50
Fiona     | 750                   |   750                   |   0
**AVG**   | **525**               |   **600**               |   **75**

--

Suppose we randomly assign 2 out of these 6 students to test prep.

- Write out all of the possible ways that random assignment could have taken place (hint: there should be 15 in total).

- For each possible randomization, calculate the ATE.  What's the average across all 15?

---

### Key Takeaways

- In this example, uncertainty arises because we could have randomly assigned subjects to treatment and control groups in different ways.

- In other words, we could have run 15 different experiments.

- Each experiment produces a different ATE. 

- If we average the results of these 15 experiments, we recover the **"true" ATE.**

- In real life, we have only 1 unique realization of all possible randomizations.

- But our 1 ATE is an **unbiased estimate** of the **"true" ATE.**

---

### Hypothesis Testing with Randomization Inference

.pull-left[

- This understanding of the sources of uncertainty suggests a way to conduct hypothesis tests.

- Here, we focus on the **sharp null hypothesis** that the treatment effect is zero for all observations.

  - Why? Because the **sharp null** allows us to fill in the missing cells of our potential outcomes schedule.
  
]
 
.pull-right[

&lt;br&gt;

Student   |   `\(Y_{i}\)`(.pink[1])     |   `\(Y_{i}\)`(.blue[0])     |   `\(D_i\)`
-         | -                       |   -                     |   -
Alex      | 300                     |   .zomp[??]             |   1
Bonnie    | 350                     |   .zomp[??]             |   1
Colin     | 500                     |   .zomp[??]             |   1
Danielle  | .zomp[??]               |   600                   |   0
Earl      | 700                     |   .zomp[??]             |   1
Fiona     | .zomp[??]               |   750                   |   0

]

---

### Class Exercise

.pull-left[

- What is the estimated ATE in this single experiment?

]


.pull-right[

&lt;br&gt;

Student   |   `\(Y_{i}\)`(.pink[1])     |   `\(Y_{i}\)`(.blue[0])     |   `\(D_i\)`
-         | -                       |   -                     |   -
Alex      | 300                     |   .zomp[??]             |   1
Bonnie    | 350                     |   .zomp[??]             |   1
Colin     | 500                     |   .zomp[??]             |   1
Danielle  | .zomp[??]               |   600                   |   0
Earl      | 700                     |   .zomp[??]             |   1
Fiona     | .zomp[??]               |   750                   |   0

]

---

### Class Exercise

.pull-left[

- What is the estimated ATE in this single experiment?

- We use the **sharp null hypothesis** to fill in the missing cells.

- Calculate the ATE under the **sharp null hypothesis** for each of the 15 possible random assignments.

- Where does your estimated ATE fall in the distribution of ATEs that could have been realized under the sharp null?

]


.pull-right[

&lt;br&gt;

Student   |   `\(Y_{i}\)`(.pink[1])     |   `\(Y_{i}\)`(.blue[0])     |   `\(D_i\)`
-         | -                       |   -                     |   -
Alex      | 300                     |   .zomp[300]             |   1
Bonnie    | 350                     |   .zomp[350]             |   1
Colin     | 500                     |   .zomp[500]             |   1
Danielle  | .zomp[600]               |   600                   |   0
Earl      | 700                     |   .zomp[700]             |   1
Fiona     | .zomp[750]               |   750                   |   0

]

---

### Summary and Takeaways

- Randomization inference tests the **sharp null hypothesis** that the treatment effect is zero for all observations.

- We use the **sharp null hypothesis** to fill in the missing cells in our potential outcomes schedule.

- With our now completed schedule of potential outcomes, we can then simulate all possible randomizations. 

  - These simulated randomizations provide an exact sampling distribution of the estimated ATE under the sharp null.
  
- Under this distribution of hypothetical outcomes, we can calculate the probability of obtaining an estimated ATE at least as large as the one we obtained from our actual experiment  *if the treatment effect were in fact zero for every subject.*

  - This probability is our **p-value.**

---

### Randomization Inference vs. Regression

- Randomization Inference highlights the logic of randomization inherent in our experimental design.

- Regression also makes a lot of assumptions (about sample size, functional form, distribution of errors, etc.)

- Randomization inference might be preferable in cases where such assumptions are unwarranted or questionable.

  - But there are also many applications (e.g. survey experiments) where regression will give you basically the same results.
  
---

### Randomization Inference with Rainfall Data

- What is the problem that [Cooperman 2017](https://www.jstor.org/stable/26563425) is trying to solve?  
  
  - i.e. what's the **contribution**?

&lt;br&gt;
--

- How does she use randomization inference to solve this problem?

  &lt;!-- - Take the very simple case of obtaining p-values for the effect of rainfall on turnout for  --&gt;

  &lt;!--     + a single presidential election, and --&gt;

  &lt;!--     + under the most conservative approach assuming that rainfall patterns are correlated across the entire United States. --&gt;
 
&lt;br&gt; 

--

**Food for thought:** this type of replication project would make for an excellent MA thesis.

---

### Next week:

- We have seen how the logic of randomization can be used to generate a distribution of possible ATEs that average out to the "true" treatment effect

- As it turns out, there are different ways to randomize, and how exactly we do it can affect the shape of this distribution. 

- We would like to make this distribution as **narrow as possible.**  .pink[Why?]

- Next week, we will talk about strategies for achieving this.

- Please read [Sands 2017.](https://doi.org/10.1073/pnas.1615010113)



    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "14:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
